<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Master Sudut - Game Geometri</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(135deg, #e0e7ff 0%, #f3e8ff 100%);
            overflow-y: auto;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }
        
        ::-webkit-scrollbar { width: 0px; background: transparent; }

        #app {
            position: relative;
            overflow: hidden; 
        }

        .game-canvas-container {
            position: relative;
            width: 100%;
            max-width: 300px;
            height: 300px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            -webkit-tap-highlight-color: transparent;
            overflow: visible; 
        }

        canvas {
            width: 100%;
            height: 100%;
            cursor: pointer;
        }

        .center-dot {
            position: absolute;
            top: 50%;
            left: 50%;
            width: 18px;
            height: 18px;
            background: #4f46e5;
            border: 4px solid white;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            box-shadow: 0 4px 6px rgba(0,0,0,0.2);
            pointer-events: none;
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-8px); }
        }
        .float-anim { animation: float 3s ease-in-out infinite; }

        @keyframes popIn {
            0% { transform: scale(0.9); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        .pop-in { animation: popIn 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) forwards; }

        .btn-push { transition: all 0.1s; }
        .btn-push:active { transform: scale(0.95); filter: brightness(0.9); }

        input[type=range] { -webkit-appearance: none; background: transparent; }
        input[type=range]::-webkit-slider-thumb {
            -webkit-appearance: none; height: 28px; width: 28px; border-radius: 50%;
            background: #4f46e5; border: 3px solid white; cursor: pointer;
            margin-top: -10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        input[type=range]::-webkit-slider-runnable-track {
            width: 100%; height: 8px; cursor: pointer; background: #e2e8f0; border-radius: 99px;
        }
        
        .vol-slider::-webkit-slider-thumb { background: #10b981; width: 18px; height: 18px; margin-top: -6px; }
        .vol-slider::-webkit-slider-runnable-track { background: #d1fae5; height: 6px; }

        .vol-slider:disabled::-webkit-slider-thumb { background: #9ca3af; cursor: not-allowed; }
        .vol-slider:disabled::-webkit-slider-runnable-track { background: #e5e7eb; }

        .modal-backdrop { background-color: rgba(0, 0, 0, 0.6); backdrop-filter: blur(4px); }
        .icon-container { padding: 10px; margin-top: 10px; }
        
        input::-webkit-outer-spin-button, input::-webkit-inner-spin-button { -webkit-appearance: none; margin: 0; }
        input[type=number] { -moz-appearance: textfield; }
    </style>
</head>
<body class="p-2 sm:p-4 pb-12 w-full h-full">

    <audio id="bgm" loop preload="auto">
        <source src="https://codeskulptor-demos.commondatastorage.googleapis.com/GalaxyInvaders/theme_01.mp3" type="audio/mpeg">
    </audio>

    <div id="app" class="w-full max-w-md bg-white rounded-[2rem] shadow-2xl overflow-hidden min-h-[700px] flex flex-col relative border-4 border-white ring-4 ring-indigo-50 mx-auto">
        
        <!-- Header -->
        <div class="bg-white px-3 py-3 flex items-center justify-between z-30 border-b border-gray-100 sticky top-0 w-full h-[70px]">
            <div class="w-12 flex justify-start">
                <button id="btn-home" onclick="playSound('pop'); switchScreen('menu')" class="hidden p-2 bg-gray-100 text-gray-600 rounded-xl hover:bg-gray-200 transition btn-push">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
                </button>
            </div>
            <div class="flex-1 text-center truncate px-1">
                <h1 class="text-lg font-extrabold tracking-tight text-indigo-900 leading-tight">MASTER<span class="text-indigo-500">SUDUT</span></h1>
            </div>
            <div class="flex items-center justify-end gap-2">
                <div id="global-score-badge" class="bg-yellow-50 text-yellow-700 px-2 py-1 rounded-xl text-xs font-bold flex items-center border border-yellow-200 shadow-sm">
                    <span class="mr-1">â­</span> <span id="total-score-display">0</span>
                </div>
                <button onclick="openSettings()" class="p-2 bg-gray-100 text-gray-700 rounded-xl hover:bg-indigo-100 hover:text-indigo-600 transition btn-push shadow-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
                </button>
            </div>
        </div>

        <!-- Content Area -->
        <div class="flex-1 flex flex-col items-center justify-center p-4 sm:p-6 relative w-full">
            
            <!-- MENU SCREEN -->
            <div id="screen-menu" class="w-full text-center pop-in flex flex-col items-center justify-center py-6">
                <div class="mb-8 float-anim relative icon-container">
                    <div class="w-32 h-32 bg-gradient-to-tr from-indigo-500 to-purple-500 rounded-full flex items-center justify-center shadow-xl shadow-indigo-200 ring-4 ring-white mx-auto">
                        <span class="text-6xl">ğŸ“</span>
                    </div>
                </div>
                <div class="space-y-1 mb-6">
                    <h2 class="text-3xl font-black text-gray-800">Siap Mengukur?</h2>
                    <p class="text-gray-500 text-sm font-medium">Latih intuisi visualmu sekarang!</p>
                </div>
                <div class="w-full space-y-4 max-w-xs">
                    <button onclick="startGame('guess')" class="w-full bg-white border-2 border-blue-100 hover:border-blue-500 p-4 rounded-3xl shadow-sm hover:shadow-lg transition-all btn-push flex items-center justify-between group">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-2xl bg-blue-100 flex items-center justify-center text-2xl group-hover:scale-110 transition">ğŸ‘ï¸</div>
                            <div class="text-left">
                                <div class="font-bold text-gray-800 text-lg">Mode Tebak</div>
                                <div class="text-xs text-gray-400 font-bold">Lihat & Tebak</div>
                            </div>
                        </div>
                    </button>
                    <button onclick="startGame('create')" class="w-full bg-white border-2 border-purple-100 hover:border-purple-500 p-4 rounded-3xl shadow-sm hover:shadow-lg transition-all btn-push flex items-center justify-between group">
                        <div class="flex items-center gap-4">
                            <div class="w-12 h-12 rounded-2xl bg-purple-100 flex items-center justify-center text-2xl group-hover:scale-110 transition">âœï¸</div>
                            <div class="text-left">
                                <div class="font-bold text-gray-800 text-lg">Mode Buat</div>
                                <div class="text-xs text-gray-400 font-bold">Lihat & Bentuk</div>
                            </div>
                        </div>
                    </button>
                </div>
            </div>

            <!-- GAME SCREEN -->
            <div id="screen-game" class="w-full hidden flex-col items-center relative h-full pb-4">
                <div class="mb-2 text-center mt-2 w-full flex flex-col items-center">
                    <div id="game-badge" class="inline-block px-4 py-1 rounded-full text-[10px] font-black uppercase tracking-widest mb-2 bg-gray-100 text-gray-500">MODE</div>
                    <div class="flex justify-center w-full">
                        <div class="bg-white px-6 py-2 rounded-3xl border-2 border-gray-100 shadow-sm w-32 flex justify-center items-center">
                             <h2 id="game-instruction-main" class="text-3xl font-black text-indigo-900">0Â°</h2>
                        </div>
                    </div>
                </div>
                <div class="game-canvas-container" id="canvas-container">
                    <canvas id="gameCanvas"></canvas>
                    <div class="center-dot"></div>
                    <div id="touch-layer" class="absolute inset-0 rounded-full z-20"></div>
                </div>
                <div id="controls-create" class="hidden text-center mt-4">
                    <p class="text-xs text-purple-600 font-bold bg-purple-50 px-4 py-2 rounded-xl inline-block shadow-sm border border-purple-100">
                        Putar garis searah jarum jam â†»
                    </p>
                </div>
                <div class="w-full mt-4 flex-1 flex flex-col justify-end">
                    <div id="controls-guess" class="hidden animate-fade-in mb-4">
                        <div class="flex items-center gap-4 bg-gray-50 p-2 pr-3 rounded-[1.5rem] border border-gray-200 shadow-inner">
                            <input type="range" id="guess-slider" min="0" max="360" value="0" class="flex-1 ml-2 accent-indigo-600">
                            <div class="relative w-20 flex-shrink-0">
                                <input type="number" id="guess-input" min="0" max="360" value="0" readonly class="w-full p-2.5 bg-gray-50 border border-gray-200 rounded-2xl text-center font-bold text-lg outline-none text-indigo-800 shadow-sm cursor-default">
                            </div>
                        </div>
                    </div>
                    <button id="btn-submit" onclick="submitAnswer()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 rounded-2xl shadow-lg shadow-indigo-200 btn-push text-lg flex justify-center items-center gap-2">
                        <span>Kunci Jawaban</span> ğŸ”’
                    </button>
                    <button id="btn-next" onclick="nextRound()" class="hidden w-full bg-green-500 hover:bg-green-600 text-white font-bold py-4 rounded-2xl shadow-lg shadow-green-200 btn-push text-lg flex justify-center items-center gap-2">
                        <span>Soal Selanjutnya</span> â¡ï¸
                    </button>
                </div>
            </div>

            <!-- RESULT OVERLAY -->
            <div id="result-overlay" class="hidden absolute inset-0 z-40 flex flex-col items-center justify-center p-4">
                <div class="absolute inset-0 bg-white/85 backdrop-blur-md rounded-[2rem]"></div>
                <div class="relative z-50 text-center w-full max-w-xs pop-in overflow-y-auto max-h-full pb-6">
                    <div class="icon-container mb-2">
                         <div id="result-icon" class="text-8xl filter drop-shadow-lg transform -rotate-12">ğŸ¯</div>
                    </div>
                    <h2 id="result-title" class="text-4xl font-black text-gray-800 mb-4">Hebat!</h2>
                    <div class="bg-white p-5 rounded-3xl shadow-xl border border-gray-100 w-full mb-4">
                        <div class="flex justify-between items-center mb-3 border-b border-gray-100 pb-3">
                            <div class="text-left"><p class="text-[10px] text-gray-400 uppercase font-bold tracking-wider">Target</p><p id="res-target" class="text-2xl font-black text-gray-800">90Â°</p></div>
                            <div class="text-right"><p class="text-[10px] text-gray-400 uppercase font-bold tracking-wider">Kamu</p><p id="res-user" class="text-2xl font-black text-indigo-600">88Â°</p></div>
                        </div>
                        <div class="flex justify-between items-center bg-gray-50 p-2 px-4 rounded-2xl mb-2">
                             <p class="text-xs font-bold text-gray-500">Selisih</p><p id="res-diff" class="text-xl font-black text-gray-700">2Â°</p>
                        </div>
                        <div class="bg-indigo-50 p-3 rounded-xl border border-indigo-100 text-left">
                            <p class="text-[10px] font-bold text-indigo-400 uppercase mb-1">Perhitungan Skor</p>
                            <p id="score-detail" class="text-xs font-mono text-indigo-900 font-bold">100 - (2 x 2) = 96</p>
                        </div>
                    </div>
                    <div class="w-full bg-gray-200 rounded-full h-4 mb-4 overflow-hidden ring-2 ring-gray-100">
                        <div id="score-bar-fill" class="h-full bg-green-500 shadow-[0_0_15px_rgba(34,197,94,0.6)] transition-all duration-1000" style="width: 0%"></div>
                    </div>
                    <button onclick="nextRound()" class="w-full bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-3.5 rounded-2xl shadow-lg btn-push text-lg">Lanjut Main</button>
                </div>
            </div>
        </div>
    </div>

    <!-- SETTINGS MODAL -->
    <div id="settings-modal" class="fixed inset-0 z-50 hidden items-center justify-center p-4 modal-backdrop animate-fade-in">
        <div class="bg-white w-full max-w-xs sm:max-w-sm rounded-[2rem] shadow-2xl p-6 relative pop-in flex flex-col max-h-[85vh] overflow-y-auto">
            <button onclick="playSound('pop'); closeSettings()" class="absolute top-4 right-4 text-gray-400 hover:text-gray-600 bg-gray-100 rounded-full p-2 z-10 btn-push">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
            </button>
            <div id="settings-view-main" class="flex flex-col gap-4">
                <h2 class="text-2xl font-black text-indigo-900 mb-2 flex items-center gap-2">
                    <span class="text-2xl">âš™ï¸</span> Pengaturan
                </h2>
                <div class="bg-gray-50 p-4 rounded-2xl space-y-4">
                    <div class="flex justify-between items-center border-b border-gray-200 pb-2 mb-2">
                        <p class="text-sm font-bold text-gray-700 flex items-center gap-2">ğŸšï¸ Atur Audio</p>
                        <button id="btn-settings-mute" onclick="toggleMute()" class="flex items-center gap-2 bg-green-100 text-green-700 px-3 py-1.5 rounded-lg text-xs font-bold transition btn-push hover:bg-green-200">
                            <span id="mute-icon">ğŸ”Š</span><span id="mute-text">Nyala</span>
                        </button>
                    </div>
                    <div id="audio-controls-container" class="space-y-4 transition-opacity duration-300">
                        <div>
                            <div class="flex justify-between text-xs text-gray-500 font-bold mb-1"><span>Musik Latar</span><span id="label-bgm-vol">50%</span></div>
                            <input type="range" id="vol-bgm" class="vol-slider w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="50">
                        </div>
                        <div>
                            <div class="flex justify-between text-xs text-gray-500 font-bold mb-1"><span>Efek Suara</span><span id="label-sfx-vol">100%</span></div>
                            <input type="range" id="vol-sfx" class="vol-slider w-full h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer" min="0" max="100" value="100">
                        </div>
                    </div>
                </div>
                <button onclick="playSound('pop'); switchSettingsView('info')" class="w-full bg-white border-2 border-indigo-100 hover:border-indigo-400 p-3 rounded-xl flex items-center justify-between text-indigo-800 font-bold transition btn-push">
                    <span class="flex items-center gap-2">â„¹ï¸ Cara Bermain</span><span class="text-indigo-300">â†’</span>
                </button>
                <button onclick="playSound('pop'); switchSettingsView('about')" class="w-full bg-white border-2 border-indigo-100 hover:border-indigo-400 p-3 rounded-xl flex items-center justify-between text-indigo-800 font-bold transition btn-push">
                    <span class="flex items-center gap-2">ğŸ‘¨â€ğŸ’» Tentang & Info</span><span class="text-indigo-300">â†’</span>
                </button>
            </div>
            <div id="settings-view-info" class="hidden flex-col gap-4">
                 <div class="flex items-center gap-2 mb-2">
                    <button onclick="playSound('pop'); switchSettingsView('main')" class="p-1 bg-gray-100 rounded-lg text-gray-500 hover:bg-gray-200 btn-push"><</button>
                    <h3 class="font-bold text-lg text-gray-800">Cara Bermain</h3>
                </div>
                <div class="text-sm text-gray-600 space-y-3 leading-relaxed bg-blue-50 p-4 rounded-2xl">
                    <p>ğŸ¯ <b>Tujuan:</b> Cocokkan sudut seakurat mungkin!</p>
                    <hr class="border-blue-100">
                    <div><b class="text-blue-700">1. Mode Tebak:</b><br>Geser slider untuk menebak derajat garis biru.</div>
                    <div><b class="text-purple-700">2. Mode Buat:</b><br>Tarik garis ungu searah jarum jam untuk membuat sudut sesuai angka target.</div>
                </div>
            </div>
            <div id="settings-view-about" class="hidden flex-col gap-4">
                 <div class="flex items-center gap-2 mb-2">
                    <button onclick="playSound('pop'); switchSettingsView('main')" class="p-1 bg-gray-100 rounded-lg text-gray-500 hover:bg-gray-200 btn-push"><</button>
                    <h3 class="font-bold text-lg text-gray-800">Tentang</h3>
                </div>
                <div class="bg-gray-50 rounded-2xl p-6 text-center">
                    <div class="w-16 h-16 bg-gradient-to-br from-indigo-400 to-purple-500 rounded-full mx-auto mb-3 flex items-center justify-center text-3xl shadow-md border-4 border-white">ğŸ‘¨â€ğŸ’»</div>
                    <p class="text-lg font-black text-indigo-900">Riyan</p>
                    <p class="text-xs text-gray-500 font-bold">Sumatera Utara, Indonesia</p>
                    <div class="mt-4 flex flex-col gap-1 text-[10px] text-gray-400 bg-white p-2 rounded-lg border border-gray-100"><span>Versi Aplikasi: 1.0 (v13)</span><span>Tanggal: 2025</span></div>
                </div>
                <a id="wa-link" href="#" target="_blank" onclick="playSound('pop')" class="block w-full bg-green-500 hover:bg-green-600 text-white text-sm font-bold py-3.5 rounded-xl shadow-lg shadow-green-200 transition flex items-center justify-center gap-2 transform active:scale-95 btn-push">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path></svg>
                    Kirim Kritik & Saran
                </a>
            </div>
        </div>
    </div>

    <footer class="fixed bottom-0 w-full text-center py-3 text-xs font-bold text-gray-400 bg-white/50 backdrop-blur-sm z-0">Â© Copyright Riyan 2025</footer>

    <script src="script.js"></script>
</body>
</html>


